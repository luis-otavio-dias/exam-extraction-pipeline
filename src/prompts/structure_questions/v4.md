## File: src/prompts/structure_questions/v4.md

### Prompt version: structure_questions/v4.md

Question Structure Instructions:

- Question ID ("question_id"):
  - Don't fill this field automatically. Leave it as an empty string `""`.

- Question Identifier (question):
  - Must ALWAYS follow the format:
    "QUESTÃO XX" (e.g., "QUESTÃO 01", "QUESTÃO 12").

  - If the text only shows a number (like "1" or "01"),
    you MUST prepend "QUESTÃO ".

  - Pad single digits with a zero (e.g., convert "1" to "01").

- The passage text ("passage_text"):
  - Some questions may have a passage before the statement that should
    be included.

  - Add break lines (\n) as needed to preserve paragraph structure.

  - If there is no passage, return an empty string for this field.

  - May contain the source of the passage text.

  - The source of the passage text must be stored in the Sources field,
    following the instructions provided.

- Sources ("sources"):
  - Each source should be a single, complete reference.

  - A list of strings indicating the source of the passage text or the
    source of an image.

  - If there is no source, return an empty list for this field.

  - Maximum of 10 sources per question.

  - **Source Types and Extraction Rules:**

    **For URLs:**
    - **NEGATIVE CONSTRAINT**: **DO NOT** include the full raw sentence
      (e.g., NEVER return "Disponível em: http...").
      DISCARD the raw phrase; keep only the extracted URL and Date.

    - Always return as TWO separate strings in the array:
      1. First string: The complete URL as it appears
      2. Second string: ONLY the access date (format: "DD mmm. YYYY")

    - Extract the access date by identifying phrases with this
      structure:
      "Acesso em: [date]" or similar patterns

    - Store ONLY the date content, WITHOUT the preceding phrase
      (e.g., store "13 out. 2023", not "Acesso em: 13 out. 2023")

    - Example:
      sources: ["https://example.com", "13 out. 2023"]

    **For book references, articles, textbooks, etc.:**
    - Return as a SINGLE string
    - Extract and store the complete reference as it appears
    - Maintain all formatting and punctuation
    - Example:
      sources: ["AUTHOR, A. Title. City: Publisher, Year."]

- Image Flag ("image"):
  - Set to `true` if the input explicitly contains an image/graph.

  - **IMPORTANT**: If a question has sources AND the
    `passage_text` is empty/missing, you MUST set `image` to `true`.

  - Otherwise, set to `false`.

- Images ("images"):
  - Don't fill this field automatically. Leave it as an empty list `[]`.
- Statement ("statement"):
  - The main text of the question command.

- Options ("options"):
  - A list of objects, each containing:
    - "label": Option label (A, B, C, D, E).
    - "text": Full text of the option.

- Correct option ("correct_option"):
  - The label of the correct option (A, B, C, D, E).

- Metadata:
  - Area "area" Classification Rules:
    -The questions' subject area.
    - You MUST choose exactly ONE of the following values:
      ["Linguagens", "Ciências Humanas"]
  - Topic "topic" Classification Rules:
    - The specific topic within the area.
    - You MUST choose exactly ONE of the following values:
      ["Literatura", "Gramática", "Interpretação de Texto", "Filosofia", "Sociologia", "História", "Geografia"]
  - Do NOT invent new labels.
  - If uncertain, choose the closest one based on content.
  - NEVER return "Unknown".

Output Instructions:

- Do NOT use markdown code fences (like ```json).
- Do NOT include any additional text, explanations, or comments.
- Do NOT add any introductory or concluding text.
- Language: Same as the input exam text.

{format_instructions}

Exam Text Fragment:
{chunk}

Answer Key:
{answer_key_text}
